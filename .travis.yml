language: node_js
node_js:
  - "lts/*"
cache: yarn
# The lines below should fix the travis build according to this issue (https://github.com/kelektiv/node.bcrypt.js/issues/366)
env:
  global:
    - secure: "K46h7xi7O2wuculWgiA9RaDC2hXH2nrXL8XyR4FQ+yn8B5wG8dBpJh/KG9nsG30IFkUuiyEngbYtDaPFqAfKeKW7zEvVZ1NTBPRbqJRV5USxSuqX9/oLDxYMgd/Ql9uQngzV/pIM9gFQ76CXb7KSV5EFwlhd42xks6Bve/KqEgXbBhiKIJi8rMwftp0JT0ljXDjutOGFTWAkIkr2LIQIv5Ubf4akyRciusTIYz8dbJVvsM/Yu9LDTJ3MJPMsGjAovEdlctYT+dr1thVwedisXh/gXZ7mGk3yEyS2NiDIMD9mDZe+EPxZqJbSLQ6h2Dr5ZOwFsNq30rhVqJztQKE4/5G/xck4wcbe5LlRm/1twZxeh/S20Wf5oDWNGn/ujdWxe/Vx5RGZ87wkwv7OgfWX3N0gkrSvV+yX34kUMVsx+6+idubWH16/kmwipjFok2vZ8jxXu8YHRDXEbq8dRfqSPzt+anXmZcw7mYJT7P4skiNJOwLvTfeEOClSXnj93SqPVzDCUYJf2MzoHPpmECDcY7I0zM8Tdu2+TdIshXrpXIeeLa6EFuVjL0DrkIjks2YgioME+QRMq7cksKWPVaKltLDyVuKG4rj1I/INF+pJz3DllRSl5+jYh5lRRpw5f6TbxhR/dcMPWxVDa+LDlFsGHfCxzjebXJk/nVqtB66NB7A="
    - CXX=g++-4.8
addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
    packages:
      - g++-4.8
deploy:
  - provider: script
    script: yarn now --token $NOW_ACCESS_TOKEN && yarn now alias --token $NOW_ACCESS_TOKEN
    skip_cleanup: true
    on:
      branch: master
  - provider: script # required env variables NETLIFY_AUTH_TOKEN
    script: cd client && yarn && yarn build && yarn netlify deploy --dir client/build --prod
    skip_cleanup: true
    on:
      branch: master

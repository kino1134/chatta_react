language: node_js
node_js:
  - "lts/*"
cache: yarn
# The lines below should fix the travis build according to this issue (https://github.com/kelektiv/node.bcrypt.js/issues/366)
env:
  - CXX=g++-4.8
addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
    packages:
      - g++-4.8
deploy:
  - provider: script
    script: yarn now --token $NOW_ACCESS_TOKEN && yarn now alias --token $NOW_ACCESS_TOKEN
    skip_cleanup: true
    on:
      branch: master
  - provider: script # required env variables NETLIFY_AUTH_TOKEN
    script: cd client && yarn build && netlify deploy --dir build --prod
    skip_cleanup: true
    on:
      branch: master
